!function(){function e(e){for(sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split("&"),i=0;i<sURLVariables.length;i++)if(sParameterName=sURLVariables[i].split("="),sParameterName[0]==e)return sParameterName[1]}function r(e){return e=e.replace(/<br\s*\/?>/gm,"\r\n"),e=e.replace(/[\r\n]+$/,"")}function a(){$.ajax({url:"/extension/wishlists.php",type:"POST",success:function(e){""==e?formWishlist.parents(".sep").append('<input type="text" id="wishlist" name="new_wishlist" />').find("select").remove():formWishlist.append(e)}})}function t(e){e.data.indexOf("drop=")>-1?(imageSrc=e.data.replace("drop=",""),formPicture.val(imageSrc),formImage.empty().css({"background-image":"url("+imageSrc+")",border:0}).removeClass("hover")):"enter"==e.data?formImage.addClass("hover"):"leave"==e.data?formImage.removeClass("hover"):"start"==e.data?formImage.addClass("start"):"end"==e.data&&formImage.removeClass("start")}container=$(".container"),form=$("form"),formImage=form.find("#image"),formPicture=form.find("#picture"),formName=form.find("#name"),formPrice=form.find("#price"),formCurrency=form.find("#currency"),formWishlist=form.find("#wishlist"),formDescription=form.find("#description"),formSubmit=form.find("#submit"),theName=decodeURI(e("name")),theName&&formName.val(theName),thePrice=decodeURI(e("price")),""!=thePrice&&"undefined"!=thePrice&&formPrice.val(thePrice),theCurrency=decodeURI(e("currency")),""!=theCurrency&&"undefined"!=theCurrency&&formCurrency.val(theCurrency),theDescription=r(decodeURI(e("description"))),theDescription=theDescription.replace("$and$","&"),theDescription=theDescription.replace("$equals$","="),""!=theDescription&&"undefined"!=theDescription&&formDescription.val(theDescription),theImage=decodeURI(e("image")),""!=theImage&&"undefined"!=theImage&&(formPicture.val(theImage),formImage.empty().css({"background-image":"url("+theImage+")",border:0}).removeClass("hover")),a(),window.addEventListener("message",t,!1)}();