!function(){function e(e){for(sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split("&"),i=0;i<sURLVariables.length;i++)if(sParameterName=sURLVariables[i].split("="),sParameterName[0]==e)return sParameterName[1]}function r(e){return e=e.replace(/<br\s*\/?>/gm,"\r\n"),e=e.replace(/[\r\n]+$/,"")}function n(e){e.data.indexOf("drop=")>-1?(imageSrc=e.data.replace("drop=",""),formPicture.val(imageSrc),formImage.empty().css({"background-image":"url("+imageSrc+")"}).addClass("found").removeClass("hover")):"enter"==e.data?formImage.addClass("hover"):"leave"==e.data?formImage.removeClass("hover"):"start"==e.data?formImage.addClass("start"):"end"==e.data&&formImage.removeClass("start")}function t(){data=form.serialize(),$.ajax({url:"/extension/add.php",type:"POST",data:data,success:function(e){alert("done")}})}container=$(".container"),form=$("form"),formImage=form.find("#image"),formPicture=form.find("#picture"),formOrigin=form.find("#origin"),formName=form.find("#name"),formPrice=form.find("#price"),formCurrency=form.find("#currency"),formWishlist=form.find("#wishlist"),formDescription=form.find("#description"),formSubmit=form.find("#submit"),theName=decodeURIComponent(e("name")),theName&&formName.val(theName),thePrice=decodeURIComponent(e("price")),""!=thePrice&&"undefined"!=thePrice&&formPrice.val(thePrice),theCurrency=decodeURIComponent(e("currency")),""!=theCurrency&&"undefined"!=theCurrency&&formCurrency.val(theCurrency),theDescription=r(decodeURIComponent(e("description"))),""!=theDescription&&"undefined"!=theDescription&&formDescription.val(theDescription),theImage=decodeURIComponent(e("image")),""!=theImage&&"undefined"!=theImage&&(formPicture.val(theImage),formImage.empty().css({"background-image":"url("+theImage+")"}).addClass("found").removeClass("hover")),theOrigin=decodeURIComponent(e("url")),""!=theOrigin&&"undefined"!=theOrigin&&formOrigin.val(theOrigin),$("select[name=wishlist]").on("change",function(){"setnew"==$(this).val()&&(new_wishlist_name=prompt("Please give this wishlist a name"),""!=new_wishlist_name&&null!=new_wishlist_name?($("input[id=new_wishlist]").remove(),$(this).after('<input id="new_wishlist" type="text" name="new_wishlist" value="'+new_wishlist_name+'" required />').siblings("#new_wishlist").hide(),$(this).children().last().before('<option value="new">'+new_wishlist_name+"</option>").prev().prop("selected",!0)):$(this).children().first().prop("selected",!0))}),window.addEventListener("message",n,!1),form.on("submit",function(){return t(),!1})}();