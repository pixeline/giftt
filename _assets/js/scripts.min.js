!function(){function e(){wh=$(window).innerHeight(),ww=$(window).innerWidth(),fix=3,0==i&&(fix=0),$(".main").height(wh-fix),$(".alter").find(".wrapper").height(wh-84),i++}function t(){e(),r(),s(),l(),FastClick.attach(document.body)}function r(){body.removeClass("nojs")}function s(){body.hasClass("wishlist")&&setTimeout(function(){f=$(".wishes"),n()},50)}function n(){f.find("li").length>0&&f.imagesLoaded(function(){f.masonry({itemSelector:".wishes li"})})}function o(){body.toggleClass("withAside"),ww>767&&$(".alter .search").find("input").focus()}function a(e){if(e.files&&e.files[0]){var i=new FileReader;i.onload=function(e){$("form .file_cont img").attr("src",e.target.result).show(),$("form .file_cont span").hide()},i.readAsDataURL(e.files[0])}}function l(){$(".alter").show(),$.ajax({url:"/_include/feed_populate.php",type:"POST",success:function(e){$(".alter .feed").empty().append(e)}})}function h(e){searchData={search:e},$.ajax({url:"/_include/search.php",type:"POST",data:{data:searchData},error:function(){return!1},success:function(e){console.log(e),$(".alter .results").empty().append(e)}})}body=$("body");var f;$(window).on("resize",function(){e()}),i=0,t(),$("#show_hide").on("click",function(){return $(".main").one("click",function(){body.hasClass("withAside")&&o()}),o(),!1}),$(".pod.collapse header").on("click",function(){$(this).siblings(".wrapper").slideToggle(200)}),feedHidden=0,$(".search").on("submit",function(e){e.preventDefault()}).find("input").on("keyup",function(e){input=$(this),alter=$(".alter"),feed=alter.find(".feed"),results=alter.find(".results"),0==feedHidden&&(feed.hide(),results.show(),feedHidden=1),""==input.val()&&(feed.show(),results.hide(),feedHidden=0),13==e.which&&(window.location.href=results.find("a").first().attr("href")),h($(this).val())}),$(document).keydown(function(e){if(37==e.keyCode){if(body.hasClass("wish view"))return target=$(".wish_navigation").find(".prev").find("a").attr("href"),"undefined"!=target&&null!=target&&(location.href=target),!1;body.hasClass("wishlist view")&&$("#show_hide").click()}else if(39==e.keyCode){if(body.hasClass("wish view"))return target=$(".wish_navigation").find(".next").find("a").attr("href"),"undefined"!=target&&null!=target&&(location.href=target),!1;body.hasClass("wishlist view")&&$("#show_hide").click()}}),$("#image").change(function(){a(this)}),$(".wishlist label").on("click",function(){$(this).toggleClass("active"),$(this).parents(".private_checkbox").siblings("input[type=text]").focus()}),$(".wishlist a.icon-plus").on("click",function(){return target=$(this).data("target"),elem=$(".wishlists li.add"),elem.toggle(),elem.find("#name").focus().removeClass("error").attr("placeholder","Name"),elem.find("form").submit(function(e){thisForm=$(this),inputName=thisForm.find("#name"),errors={},inputName.val()||(errors.name="Please give it a name"),thisForm.find("#name").removeClass("error").attr("placeholder","Name"),$.each(errors,function(i,t){thisForm.find("input[name="+i+"]").addClass("error").attr("placeholder",t),e.preventDefault()})}),elem.on("click",function(e){e.stopPropagation()}),$("html").one("click",function(){elem.hide(),$(".wishlist").show()}),!1}),$(".wishlist a.icon-edit").on("click",function(){return parent=$(this).parent("li"),parent.hide(),parent.next().show(),parent.next().find("form").find("#name").focus(),parent.next().find("form").submit(function(e){thisForm=$(this),inputName=thisForm.find("#name"),errors={},inputName.val()||(errors.name="Please give it a name"),thisForm.find("input").removeClass("error"),thisForm.find("#name").attr("placeholder","Name"),$.each(errors,function(i,t){thisForm.find("input[name="+i+"]").addClass("error").attr("placeholder",t),e.preventDefault()})}),parent.next().on("click",function(e){e.stopPropagation()}),$("html").one("click",function(){$(".wishlists .edit").hide(),$(".wishlist").show()}),!1}),$("li.edit .remove").on("click",function(){$(this).submit()}),$(".wish.add, .wish.edit").find("form").on("submit",function(){return formName=$(this).find("input#name"),formWishlist=$(this).find("select#wishlist"),formImage=$(this).find("input#image"),formImageExtension=formImage.val().split(".").pop().toLowerCase(),$("p.error").remove(),formName.removeClass("error"),formWishlist.removeClass("error"),$(".file_cont").removeClass("error"),errors={},""==formName.val()&&(errors.name="You must provide a name"),null==formWishlist.val()&&(errors.wishlist="You must select a wishlist"),""==formImage.val()&&"/"==formImage.siblings("img").attr("src")?errors.image="You must provide a picture":""!=formImage.val()&&formImage[0].files[0].size>1048576?errors.image="The picture is too big (limited to 1 mo)":""!=formImage.val()&&-1==$.inArray(formImageExtension,["gif","png","jpg","jpeg"])&&(errors.image="The picture should be a .jpg, .png or .gif file"),errors.name&&formName.addClass("error").after('<p class="error">'+errors.name+"</p>").siblings(".error").show(),errors.wishlist&&formWishlist.addClass("error").after('<p class="error">'+errors.wishlist+"</p>").siblings(".error").show(),errors.image&&$(".file_cont").addClass("error").find("input").after('<p class="error">'+errors.image+"</p>").siblings(".error").show(),errors.name||errors.wishlist||errors.image?!1:void 0}),$(".wish.add, .wish.edit").find("select[name=wishlist]").on("change",function(){"setnew"==$(this).val()&&(new_wishlist_name=prompt("Please give this wishlist a name"),""!=new_wishlist_name&&"null"!=new_wishlist_name?($("input[id=new_wishlist]").remove(),$(this).after('<input id="new_wishlist" type="text" name="new_wishlist" value="'+new_wishlist_name+'" required />').siblings("#new_wishlist").hide(),$(this).children().last().before('<option value="new">'+new_wishlist_name+"</option>").prev().prop("selected",!0)):$(this).children().first().prop("selected",!0))})}();