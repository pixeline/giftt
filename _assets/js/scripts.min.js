!function(){function t(){wh=$(window).innerHeight(),$(".main").height(wh),$("aside").find(".wrapper").height(wh-80)}function i(){t(),e(),n()}function e(){body.removeClass("nojs")}function n(){(body.hasClass("wishlist")&&body.hasClass("view")||body.hasClass("user")&&body.hasClass("view"))&&setTimeout(function(){g=$(".wishes"),g.find(".wish").not(".add").length>0&&g.imagesLoaded(function(){g.masonry({columnWidth:".wishes li:nth-child(2)",itemSelector:".wishes li"})})},50)}function o(t){return t.hasClass("active")?!1:(id=t.attr("id"),t.siblings("li").removeClass("active"),t.addClass("active"),wishlists=$(".wishlists"),wishlistsAll=wishlists.find(".public, .private"),wishlistsAll.fadeOut(200),void setTimeout(function(){wishlists.find("li."+id).fadeIn(200)},200))}function a(){body.toggleClass("withAside"),m(),setTimeout(function(){g.masonry()},250)}function s(t){tag=t.prop("tagName").toLowerCase(),type=t.prop("type").toLowerCase(),"input"==tag?(r(t,tag),"file"==type&&(l(t),d(t))):"select"==tag?r(t,tag):"textarea"==tag&&r(t,tag)}function r(t){t.attr("required")&&("input"==tag?"file"==type?t.val().length||"/"!=t.siblings("img").attr("src")||(name=t.attr("id"),errors[name]=tag):t.val().length||(name=t.attr("id"),errors[name]=tag):"select"==tag?(bar=t.find("option:selected").attr("value"),bar||(name=t.attr("id"),errors[name]=tag)):"textarea"==tag&&(t.val().length||(name=t.attr("id"),errors[name]=tag)))}function l(t){ext=t.val().substring(t.val().lastIndexOf(".")+1),t.val().length&&"jpg"!=ext&&"jpeg"!=ext&&"png"!=ext&&"gif"!=ext&&(name="image",errors[name]=tag)}function d(t){file=t[0].files[0],file&&(file.size>1e6||t.fileSize>1e6)&&(name="image",errors[name]=tag)}function c(t){$(".modal."+t).fadeIn(200).addClass("show"),p=!0,init_img=$(".modal."+w).find("img").attr("src")}function f(){$(".modal."+w).find("button.close").click()}function u(t){if(t.files&&t.files[0]){var i=new FileReader;i.onload=function(t){$("form .file_cont img").attr("src",t.target.result).css({display:"block"}),$("form .file_cont span").hide()},i.readAsDataURL(t.files[0])}}function h(t,i){followData={who2:t},$.ajax({url:"/_include/follow.php",type:"POST",data:{data:followData},dataType:"text",error:function(){return!1},success:function(){title=i.find(".title"),number=i.find(".number"),i.parents(".follow").toggleClass("following"),"Following"==title.text()?(title.text("Follow"),number.text(parseInt(number.text())-1)):(title.text("Following"),number.text(parseInt(number.text())+1))}})}function m(){$.ajax({url:"/_include/show_feed.php",type:"POST"})}body=$("body");var g;$(window).on("resize",function(){t()}),i(),$(".menu li").on("click",function(){o($(this))}),$("#showAside").on("click",function(){return a(),!1}),form=$("form"),form.submit(function(){return thisForm=$(this),fields=$(this).find("input, textarea, select, radio"),errors={},thisForm.find("label, input, select, textarea").removeClass("error"),fields.each(function(){s($(this))}),$.each(errors,function(t,i){thisForm.find("label[for="+t+"]").addClass("error"),thisForm.find(i+"[id="+t+"]").addClass("error")}),$.isEmptyObject(errors)?void 0:!1});var w,p=!1;$(".modal_trigger").on("click",function(){return w=$(this).data("target"),c(w),!1}),$("button.close").on("click",function(){$(".modal."+w).fadeOut(200,function(){$(this).removeClass("show"),$(this).find("label, input, select, textarea, radio").removeClass("error"),imgCont=$(this).find(".file_cont"),w.indexOf("add")>=0?(imgCont.find("img").attr("src","/").hide(),imgCont.find("span.icon").show()):w.indexOf("edit")>=0&&imgCont.find("img").attr("src",init_img)}),p=!1}),$(".modal .container").on("click",function(t){t.stopPropagation()}),$(".modal").on("click",function(){f()}),$(document).keydown(function(t){27==t.keyCode&&p&&(f(),t.preventDefault())}),$(".wish.view").find(".button .hide_edit").on("click",function(){return $(".hide_edit").hide(),$(".show_edit").show(),edit=1,!1}),$("#link").on("click",function(){return 1==edit?($("input#image").click(),!1):void 0}),$("#image").change(function(){u(this)}),$(".button.canfollow a").on("click",function(){return button=$(this),who2=button.data("who2"),h(who2,button),!1}),$(".beta").find(".close").on("click",function(){$(this).parents(".beta").slideUp()})}();